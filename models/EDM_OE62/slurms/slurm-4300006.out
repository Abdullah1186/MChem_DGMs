/var/spool/slurmd/job4300006/slurm_script: line 11: module: command not found
/var/spool/slurmd/job4300006/slurm_script: line 12: module: command not found
/var/spool/slurmd/job4300006/slurm_script: line 13: module: command not found
/users/afekaiki/EDM/myenv/lib/python3.8/site-packages/numpy/core/fromnumeric.py:43: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.
  result = getattr(asarray(obj), method)(*args, **kwds)
/users/afekaiki/EDM/e3_diffusion_for_molecules/eval_analyze.py:156: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  flow_state_dict = torch.load(join(eval_args.model_path, fn), map_location=device)
Not importing rdkit functions.
Namespace(aggregation_method='sum', attention=True, augment_noise=0, batch_size=64, break_train_epoch=False, clip_grad=True, condition_time=True, conditioning=[], context_node_nf=0, cuda=True, current_epoch=4036, data_augmentation=False, dataset='oe62', dequantization='argmax_variational', device=device(type='cuda'), diffusion_loss_type='l2', diffusion_noise_precision=1e-05, diffusion_noise_schedule='polynomial_2', diffusion_steps=1000, dp=True, ema_decay=0.9999, exp_name='edm_oe62_resume', filter_molecule_size=None, filter_n_atoms=None, generate_epochs=1, include_charges=False, inv_sublayers=1, lr=0.0001, model='egnn_dynamics', n_epochs=10000, n_layers=4, n_report_steps=50, n_stability_samples=500, nf=256, no_cuda=False, no_wandb=False, norm_constant=1, normalization_factor=1.0, normalize_factors=[1, 4, 10], num_workers=0, ode_regularization=0.001, online=True, probabilistic_model='diffusion', remove_h=False, resume='/users/afekaiki/EDM/outputs/edm_oe62_resume', save_model=True, sequential=False, sin_embedding=False, start_epoch=3691, tanh=True, test_epochs=15, trace='hutch', visualize_every_batch=10000, wandb_usr=None)
Entropy of n_nodes: H[N] -4.140960693359375
alphas2 [9.99990000e-01 9.99988000e-01 9.99982000e-01 ... 2.59676966e-05
 1.39959211e-05 1.00039959e-05]
gamma [-11.51291546 -11.33059532 -10.92513058 ...  10.55863126  11.17673063
  11.51251595]
	 100/12000 Molecules generated at 8.20 secs/sample
	 200/12000 Molecules generated at 8.20 secs/sample
	 300/12000 Molecules generated at 8.20 secs/sample
	 400/12000 Molecules generated at 8.20 secs/sample
	 500/12000 Molecules generated at 8.20 secs/sample
	 600/12000 Molecules generated at 8.20 secs/sample
	 700/12000 Molecules generated at 8.20 secs/sample
	 800/12000 Molecules generated at 8.20 secs/sample
	 900/12000 Molecules generated at 8.20 secs/sample
	 1000/12000 Molecules generated at 8.20 secs/sample
	 1100/12000 Molecules generated at 8.20 secs/sample
	 1200/12000 Molecules generated at 8.20 secs/sample
	 1300/12000 Molecules generated at 8.20 secs/sample
	 1400/12000 Molecules generated at 8.20 secs/sample
	 1500/12000 Molecules generated at 8.20 secs/sample
	 1600/12000 Molecules generated at 8.20 secs/sample
	 1700/12000 Molecules generated at 8.20 secs/sample
	 1800/12000 Molecules generated at 8.20 secs/sample
	 1900/12000 Molecules generated at 8.20 secs/sample
	 2000/12000 Molecules generated at 8.20 secs/sample
	 2100/12000 Molecules generated at 8.20 secs/sample
	 2200/12000 Molecules generated at 8.20 secs/sample
	 2300/12000 Molecules generated at 8.20 secs/sample
	 2400/12000 Molecules generated at 8.20 secs/sample
	 2500/12000 Molecules generated at 8.20 secs/sample
	 2600/12000 Molecules generated at 8.20 secs/sample
	 2700/12000 Molecules generated at 8.20 secs/sample
	 2800/12000 Molecules generated at 8.20 secs/sample
	 2900/12000 Molecules generated at 8.20 secs/sample
	 3000/12000 Molecules generated at 8.20 secs/sample
	 3100/12000 Molecules generated at 8.20 secs/sample
	 3200/12000 Molecules generated at 8.20 secs/sample
	 3300/12000 Molecules generated at 8.20 secs/sample
	 3400/12000 Molecules generated at 8.20 secs/sample
	 3500/12000 Molecules generated at 8.20 secs/sample
	 3600/12000 Molecules generated at 8.20 secs/sample
	 3700/12000 Molecules generated at 8.20 secs/sample
	 3800/12000 Molecules generated at 8.20 secs/sample
	 3900/12000 Molecules generated at 8.20 secs/sample
	 4000/12000 Molecules generated at 8.20 secs/sample
	 4100/12000 Molecules generated at 8.20 secs/sample
	 4200/12000 Molecules generated at 8.20 secs/sample
	 4300/12000 Molecules generated at 8.20 secs/sample
	 4400/12000 Molecules generated at 8.20 secs/sample
	 4500/12000 Molecules generated at 8.20 secs/sample
	 4600/12000 Molecules generated at 8.20 secs/sample
	 4700/12000 Molecules generated at 8.20 secs/sample
	 4800/12000 Molecules generated at 8.20 secs/sample
	 4900/12000 Molecules generated at 8.20 secs/sample
	 5000/12000 Molecules generated at 8.20 secs/sample
	 5100/12000 Molecules generated at 8.20 secs/sample
	 5200/12000 Molecules generated at 8.20 secs/sample
	 5300/12000 Molecules generated at 8.20 secs/sample
	 5400/12000 Molecules generated at 8.20 secs/sample
	 5500/12000 Molecules generated at 8.20 secs/sample
	 5600/12000 Molecules generated at 8.20 secs/sample
	 5700/12000 Molecules generated at 8.20 secs/sample
	 5800/12000 Molecules generated at 8.20 secs/sample
	 5900/12000 Molecules generated at 8.20 secs/sample
	 6000/12000 Molecules generated at 8.20 secs/sample
	 6100/12000 Molecules generated at 8.20 secs/sample
	 6200/12000 Molecules generated at 8.20 secs/sample
	 6300/12000 Molecules generated at 8.20 secs/sample
	 6400/12000 Molecules generated at 8.20 secs/sample
	 6500/12000 Molecules generated at 8.20 secs/sample
	 6600/12000 Molecules generated at 8.20 secs/sample
	 6700/12000 Molecules generated at 8.20 secs/sample
	 6800/12000 Molecules generated at 8.20 secs/sample
	 6900/12000 Molecules generated at 8.20 secs/sample
	 7000/12000 Molecules generated at 8.20 secs/sample
	 7100/12000 Molecules generated at 8.20 secs/sample
	 7200/12000 Molecules generated at 8.20 secs/sample
	 7300/12000 Molecules generated at 8.20 secs/sample
	 7400/12000 Molecules generated at 8.20 secs/sample
	 7500/12000 Molecules generated at 8.20 secs/sample
	 7600/12000 Molecules generated at 8.20 secs/sample
	 7700/12000 Molecules generated at 8.20 secs/sample
	 7800/12000 Molecules generated at 8.20 secs/sample
	 7900/12000 Molecules generated at 8.21 secs/sample
	 8000/12000 Molecules generated at 8.21 secs/sample
	 8100/12000 Molecules generated at 8.21 secs/sample
	 8200/12000 Molecules generated at 8.21 secs/sample
	 8300/12000 Molecules generated at 8.21 secs/sample
	 8400/12000 Molecules generated at 8.21 secs/sample
	 8500/12000 Molecules generated at 8.21 secs/sample
	 8600/12000 Molecules generated at 8.21 secs/sample
	 8700/12000 Molecules generated at 8.21 secs/sample
	 8800/12000 Molecules generated at 8.21 secs/sample
	 8900/12000 Molecules generated at 8.21 secs/sample
	 9000/12000 Molecules generated at 8.21 secs/sample
	 9100/12000 Molecules generated at 8.21 secs/sample
	 9200/12000 Molecules generated at 8.21 secs/sample
	 9300/12000 Molecules generated at 8.22 secs/sample
	 9400/12000 Molecules generated at 8.22 secs/sample
	 9500/12000 Molecules generated at 8.22 secs/sample
	 9600/12000 Molecules generated at 8.22 secs/sample
	 9700/12000 Molecules generated at 8.22 secs/sample
	 9800/12000 Molecules generated at 8.22 secs/sample
	 9900/12000 Molecules generated at 8.22 secs/sample
	 10000/12000 Molecules generated at 8.22 secs/sample
	 10100/12000 Molecules generated at 8.22 secs/sample
	 10200/12000 Molecules generated at 8.22 secs/sample
	 10300/12000 Molecules generated at 8.22 secs/sample
	 10400/12000 Molecules generated at 8.22 secs/sample
	 10500/12000 Molecules generated at 8.22 secs/sample
	 10600/12000 Molecules generated at 8.23 secs/sample
	 10700/12000 Molecules generated at 8.23 secs/sample
	 10800/12000 Molecules generated at 8.23 secs/sample
	 10900/12000 Molecules generated at 8.23 secs/sample
	 11000/12000 Molecules generated at 8.23 secs/sample
	 11100/12000 Molecules generated at 8.23 secs/sample
	 11200/12000 Molecules generated at 8.23 secs/sample
	 11300/12000 Molecules generated at 8.23 secs/sample
	 11400/12000 Molecules generated at 8.23 secs/sample
	 11500/12000 Molecules generated at 8.23 secs/sample
	 11600/12000 Molecules generated at 8.23 secs/sample
	 11700/12000 Molecules generated at 8.23 secs/sample
	 11800/12000 Molecules generated at 8.23 secs/sample
	 11900/12000 Molecules generated at 8.23 secs/sample
	 12000/12000 Molecules generated at 8.23 secs/sample
{'mol_stable': 0.023583333333333335, 'atm_stable': 0.8295016364504103}
Install rdkit roolkit to obtain Validity, Uniqueness, Novelty
 Val NLL 	, iter: 0/97, NLL: 38.35
 Val NLL 	, iter: 50/97, NLL: -84.51
Final val nll -148.01837392495526
 Test NLL 	, iter: 0/97, NLL: -62.31
 Test NLL 	, iter: 50/97, NLL: -78.14
Final test nll -94.90902533248871
Overview: val nll -148.01837392495526 test nll -94.90902533248871 {'mol_stable': 0.023583333333333335, 'atm_stable': 0.8295016364504103}
